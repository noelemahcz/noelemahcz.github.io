---
title: "[TIL] åˆè¢« CMake å‘äº†ï¼ˆCMP0194ï¼‰"
categories: [Environment, C++]
tags: [TIL, C++, CMake]
---

---

## èµ·å› 

ä»Šå¤©æ¸…ç†äº†ä¸€ä¸‹é¡¹ç›®çš„æ„å»ºç¼“å­˜ï¼Œè®© Conan é‡æ–°æ„å»º FFmpeg 8.0.1ï¼Œç»“æœåœ¨ç¼–è¯‘ libpng ä¾èµ–é¡¹æ—¶ï¼ŒCMake æŠ¥é”™ï¼š

```cmake
-- ...
-- The ASM compiler identification is unknown.
-- Didn't find assembler.
-- No CMAKE_ASM_COMPILER could be found.
-- ...
```

ä½†åœ¨è¿™ä¹‹å‰æ˜æ˜æ˜¯å¯ä»¥æ­£å¸¸ç¼–è¯‘çš„ï¼Œå¹¶ä¸” CMake å¯ä»¥æ‰¾åˆ° `cl.exe` å´æ‰¾ä¸åˆ°æ±‡ç¼–å™¨å±å®éå¸¸è¯¡å¼‚ï¼Œæˆ‘åœ¨ Google ä¸Šå¤§é‡æœç´¢ `conan ffmpeg libpng CMAKE_ASM_COMPILER` ç­‰å…³é”®å­—ç»„åˆä½†ä¸€æ— æ‰€è·ã€‚

äºæ˜¯æˆ‘åªèƒ½ç–¯ç‹‚å›å¿†æœ€è¿‘ä¸€æ®µæ—¶é—´æˆ‘çš„å¼€å‘ç¯å¢ƒæ˜¯å¦æœ‰å˜åŠ¨ï¼Œæˆ‘æ€€ç–‘è¿‡ MSVC ç‰ˆæœ¬å’Œ Windows SDK ç‰ˆæœ¬ï¼Œä¹Ÿæ€€ç–‘è¿‡æ˜¯ä¸æ˜¯æˆ‘è®°é”™äº†ä»¥å‰çš„æ„å»ºå‚æ•°ï¼Œæ€»ä¹‹æˆ‘æŠ˜è…¾äº†å‡ ä¸ªå°æ—¶ï¼ŒåŒ…æ‹¬æ›´æ–° MSVC å·¥å…·é“¾ç‰ˆæœ¬ï¼Œå¸è½½æ–°ç‰ˆ Windows SDKï¼Œæ¸…ç† Conan ç¼“å­˜ã€å°è¯• FFmpeg 7.1.3 ç‰ˆæœ¬ç­‰ç­‰ï¼Œä½†æŠ¥é”™ä¾æ—§ä¸å˜ã€‚

---

## ç½ªé­ç¥¸é¦– --- CMake 4.1+

æˆ‘ä¸æ˜¯æ²¡æœ‰æ€€ç–‘è¿‡ CMakeï¼Œä½†æˆ‘çœŸçš„ä¸è®°å¾—æˆ‘æ›´æ–°è¿‡ CMake ç‰ˆæœ¬ï¼Œæˆ‘ä»¥ä¸ºè¿™ä¸æ˜¯ä¸€ä¸ªå˜é‡ï¼Œä½†æˆ‘å®åœ¨èµ°æŠ•æ— è·¯ï¼Œè¿˜æ˜¯å°è¯•å°† CMake ä» 4.1 å›é€€åˆ° 3.28ï¼Œäºæ˜¯é—®é¢˜ç¥å¥‡åœ°è§£å†³äº†ã€‚

æ‰¾åˆ°äº†ç½ªé­ç¥¸é¦– CMakeï¼Œå‰©ä¸‹çš„å°±æ˜¯åˆ†æé—®é¢˜äº§ç”Ÿçš„åŸå› ï¼ŒæŸ¥çœ‹ [**CMake Release Notes**](https://cmake.org/cmake/help/latest/release/4.1.html)ï¼Œå‘ç° 4.1 ç‰ˆæœ¬æ–°å¢äº†ä¸€ä¸ª **Policy** --- [**CMP0194**](#ref1)ã€‚

è¿™ä¸ª Policy ç®€å•æ¥è¯´å°±æ˜¯ä¸å†å°† `cl.exe` è§†ä¸ºâ€œåˆæ³•â€çš„æ±‡ç¼–å™¨ï¼Œå› æ­¤åœ¨ **MSVC** å·¥å…·é“¾ä¸‹éœ€è¦æ‰‹åŠ¨æŒ‡å®šæ±‡ç¼–å™¨ã€‚

libpng è¿™ä¸ªåº“åœ¨ `CMakeLists.txt` çš„ `project` å£°æ˜ä¸­åŒ…å«äº† `ASM`ï¼Œå¯¼è‡´ CMake éœ€è¦æ£€æµ‹æ±‡ç¼–å™¨ï¼Œå¹¶ä¸” libpng åœ¨ [**1.6.52**](https://github.com/pnggroup/libpng/blob/fbed16182b92eeb3a06d96e49f0836d450318098/CMakeLists.txt#L17) ç‰ˆæœ¬å°† `cmake_minimum_version` æ›´æ–°ä¸ºåŒ…å« CMake 4.2 ç‰ˆæœ¬ï¼Œä½¿å¾— CMP0194 ç”Ÿæ•ˆï¼Œæœ€ç»ˆå¯¼è‡´æ­¤ç‰ˆæœ¬åœ¨ MSVC ç¯å¢ƒä¸‹æ„å»ºå¤±è´¥ï¼Œè€Œ [**Conan Center**](https://conan.io/center/recipes/libpng?version=1.6.52) ä¸­çš„ ffmpeg 7.0+ æ°å¥½éƒ½ä¾èµ–è¿™ä¸ªç‰ˆæœ¬ã€‚

---

## è§£å†³æ–¹æ¡ˆ

æœ€ç®€å•çš„æ–¹å¼å°±æ˜¯ä½¿ç”¨ CMake 4.1 ä»¥ä¸‹çš„ç‰ˆæœ¬ï¼Œç„¶åç­‰ Conan Center æ›´æ–° libpng ç‰ˆæœ¬åˆ° **1.6.53**ï¼Œä¹Ÿå¯ä»¥æ‰‹åŠ¨åˆ é™¤æ‰ Conan æœ¬åœ°æ„å»ºç¼“å­˜ä¸­ libpng çš„ `CMakeLists.txt` ä¸­çš„ `ASM` å£°æ˜é¡¹ã€‚

---

## æ›´å¤šä¿¡æ¯

è¿›ä¸€æ­¥æœç´¢ libpng ç›¸å…³çš„ issuesï¼Œå‘ç°å·²ç»æœ‰äººæå‡ºè¿‡è¿™ä¸ª[**é—®é¢˜**](#ref2)ï¼Œå¹¶ä¸” libpng çš„ç»´æŠ¤è€…ä¹Ÿç«‹å³è¿›è¡Œäº†[**ä¿®å¤**](#ref3)ï¼Œå¹¶å‘å¸ƒäº† **1.6.53** ç‰ˆæœ¬ã€‚

ä¿®å¤æ–¹å¼éå¸¸ç®€å•ï¼Œå°±æ˜¯ç§»é™¤äº† `project` å£°æ˜ä¸­çš„ `ASM` é¡¹ï¼Œå› ä¸º libpng æ—©å·²ä¸å†ä¾èµ–æ±‡ç¼–å™¨ï¼Œè¿™æ˜¯ä¸€ä¸ªå†å²é—ç•™é—®é¢˜ã€‚

> ä»Šå¤©æ˜¯ **2025/12/08**ï¼Œè€Œè¿™ä¸ª patch å‘å¸ƒäº **2025/12/05**ï¼Œä¸‰å¤©æ—¶é—´ï¼ŒConan è¿˜æ²¡æ¥å¾—åŠåˆå¹¶è¿™ä¸ªä¿®å¤ï¼Œæˆ‘æ­£å¥½èµ¶ä¸Šè¿™ä¸ªä¸­é—´èŠ‚ç‚¹ï¼Œè¿æ°”å¥½å·® ğŸ˜’
{: .prompt-info }

---

## æ€»ç»“

æ•™è®­å°±æ˜¯ä¸è¦æ€»æ˜¯æ¿€è¿›åœ°æ›´æ–°å·¥å…·é“¾ï¼Œè™½ç„¶æˆ‘ä¹Ÿä¸æ˜¯ç¬¬ä¸€æ¬¡è¢«è¿™ç§é—®é¢˜å‘äº†ï¼Œå¯¹äºä¸ªäººå¼€å‘ç¯å¢ƒè€Œè¨€å…¶å®è¿˜å¥½ï¼Œæ¯•ç«Ÿè§£å†³é—®é¢˜çš„è¿‡ç¨‹æœ¬èº«ä¹Ÿæ˜¯ä¸€ç§ç»éªŒç§¯ç´¯ã€‚

å·¥ä½œä¸­ä¸€å®šä¸è¦è½»æ˜“å°è¯•æ›´æ–°å·¥å…·é“¾å’Œä¾èµ–ç‰ˆæœ¬ï¼Œå¦åˆ™ä¸€æ—¦å‘ç”Ÿé—®é¢˜ï¼Œè½»åˆ™è€½è¯¯æ—¶é—´ï¼Œé‡åˆ™å½±å“å›¢é˜Ÿè¿›åº¦ï¼Œç™¾å®³æ— ä¸€åˆ©ã€‚

> è¿™ä¹Ÿåˆä¸€æ¬¡çªæ˜¾äº† Nix å“²å­¦ï¼ˆå¯å¤ç°æ€§/ç¯å¢ƒéš”ç¦»ï¼‰çš„å«é‡‘é‡ã€‚
{: .prompt-tip }

---

## References

1. <span id="ref1">[**[CMake Policy]** CMP0194](https://cmake.org/cmake/help/latest/policy/CMP0194.html)</span>
2. <span id="ref2">[**[Issue #770]** libpng 1.6.52 + MSVC + CMake 4.2 configuration failure](https://github.com/pnggroup/libpng/issues/770)</span>
3. <span id="ref3">[**[PR #772]** remove leftover ASM language from cmake project()](https://github.com/pnggroup/libpng/pull/772)</span>
